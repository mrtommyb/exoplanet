<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
<title>Scalable Gaussian processes in PyMC3 &mdash; exoplanet 0.3.1.dev1+gc54f7b4 documentation</title>
  

<link rel="shortcut icon" href="../../_static/logo.png"/><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700">
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto+Mono"><link rel="stylesheet" href="../../_static/typlog.css?v=0.7.3" type="text/css" />
  <link rel="stylesheet" href="../../_static/theme.css?v=0.7.3" type="text/css" /><link rel="stylesheet" href="../../_static/css/exoplanet.css?v=2020-01-15" type="text/css" />
      <link rel="index" title="Index" href="../../genindex/"/>
      <link rel="search" title="Search" href="../../search/"/>
    <link rel="top" title="exoplanet 0.3.1.dev1+gc54f7b4 documentation" href="../../"/>
      <link rel="prev" title="Astrometric fitting" href="../astrometric/"/>
  <script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');ga('create', '');ga('send', 'pageview');</script>
  <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/language_data.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>

  <meta property="og:type" content="website">
  <meta property="og:site_name" content="exoplanet">
  <meta property="og:title" content="Scalable Gaussian processes in PyMC3">
  <meta name="twitter:card" content="summary">
<script src="https://kit.fontawesome.com/12d959964a.js" crossorigin="anonymous"></script>
<script src="https://unpkg.com/mustache@latest"></script>
<script>
    $.ajax({
        dataType: "json",
        url: "https://raw.githubusercontent.com/exoplanet-dev/exoplanet/gh-pages/versions.json",
        success: function (data) {
            var versions = Object.keys(data).sort();
            $(function render() {
                var template = document.getElementById('versions-template').innerHTML;
                var rendered = Mustache.render(template, { versions: versions });
                document.body.innerHTML += rendered;
                $(".current-version").click(function () {
                    $(".versions-dropdown").toggle();
                });
            });
        }
    });
</script>

</head>
<body role="document" data-page="tutorials/gp">
  <header class="t-head">
    <div class="t-head_menu"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="M64 384h384v-42.666H64V384zm0-106.666h384v-42.667H64v42.667zM64 128v42.665h384V128H64z"/></svg></div>
    <a class="t-head_logo" href="../../"><img src="../../_static/logo.png" alt="Logo"/>exoplanet
    </a>
  </header>
  <aside class="t-sidebar">
    <div class="t-sidebar_close">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="M405 136.798L375.202 107 256 226.202 136.798 107 107 136.798 226.202 256 107 375.202 136.798 405 256 285.798 375.202 405 405 375.202 285.798 256z"/></svg>
    </div>
    <div class="inner">
<a class="logo" href="../../"><img src="../../_static/logo.png" alt="Logo"/>
    exoplanet
</a><div class="globaltoc">
<p class="caption"><span class="caption-text">User Guide</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../user/install/">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../citation/">Citing exoplanet &amp; its dependencies</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../user/api/">API documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../user/dev/">Developer documentation</a></li>
</ul>
<p class="caption"><span class="caption-text">Tutorials</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../intro-to-pymc3/">A quick intro to PyMC3 for exoplaneteers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pymc3-extras/">PyMC3 extras</a></li>
<li class="toctree-l1"><a class="reference internal" href="../rv/">Radial velocity fitting</a></li>
<li class="toctree-l1"><a class="reference internal" href="../transit/">Transit fitting</a></li>
<li class="toctree-l1"><a class="reference internal" href="../astrometric/">Astrometric fitting</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Scalable Gaussian processes in PyMC3</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#citations">Citations</a></li>
</ul>
</li>
</ul>

</div><div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../../">Documentation overview</a><ul>
      <li>Previous: <a href="../astrometric/" title="previous chapter">Astrometric fitting</a></li>
  </ul></li>
</ul>
</div>
<div id="searchbox">
  <form class="search" action="../../search/" method="get">
    <div class="input-group">
      <input type="text" name="q" placeholder="Search" />
      <button type="submit">Go</button>
    </div>
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
    </div>
  </aside>
  <div class="t-content">
    <div class="t-body yue">
      


  <span class="target" id="module-exoplanet"></span><div class="admonition note">
<p class="admonition-title">Note</p>
<p>This tutorial was generated from an IPython notebook that can be
downloaded <a class="reference external" href="../../_static/notebooks/gp.ipynb">here</a>.</p>
</div>
<div class="section" id="scalable-gaussian-processes-in-pymc3">
<span id="gp"></span><h1>Scalable Gaussian processes in PyMC3<a class="headerlink" href="#scalable-gaussian-processes-in-pymc3" title="Permalink to this headline">¶</a></h1>
<p>PyMC3 has support for <a class="reference external" href="https://docs.pymc.io/gp.html">Gaussian Processes
(GPs)</a>, but this implementation is too
slow for many applications in time series astrophysics. So <em>exoplanet</em>
comes with an implementation of scalable GPs powered by
<a class="reference external" href="https://celerite.readthedocs.io/">celerite</a>. More information about
the algorithm can be found in the <a class="reference external" href="https://celerite.readthedocs.io/">celerite
docs</a> and in the papers (<a class="reference external" href="https://arxiv.org/abs/1703.09710">Paper
1</a> and <a class="reference external" href="https://arxiv.org/abs/1801.10156">Paper
2</a>), but this tutorial will give a
hands on demo of how to use celerite in PyMC3.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>For the best results, we generally recommend the use of the <a class="reference internal" href="../../user/api/#exoplanet.gp.terms.SHOTerm" title="exoplanet.gp.terms.SHOTerm"><code class="xref py py-class docutils literal notranslate"><span class="pre">exoplanet.gp.terms.SHOTerm</span></code></a>, <a class="reference internal" href="../../user/api/#exoplanet.gp.terms.Matern32Term" title="exoplanet.gp.terms.Matern32Term"><code class="xref py py-class docutils literal notranslate"><span class="pre">exoplanet.gp.terms.Matern32Term</span></code></a>, and <a class="reference internal" href="../../user/api/#exoplanet.gp.terms.RotationTerm" title="exoplanet.gp.terms.RotationTerm"><code class="xref py py-class docutils literal notranslate"><span class="pre">exoplanet.gp.terms.RotationTerm</span></code></a> “terms” because the other terms tend to have unphysical behavior at high frequency.</p>
</div>
<p>Let’s start with the quickstart demo from the <a class="reference external" href="https://celerite.readthedocs.io/en/stable/tutorials/first/">celerite
docs</a>.
We’ll fit the following simulated dataset using the sum of two
<a class="reference internal" href="../../user/api/#exoplanet.gp.terms.SHOTerm" title="exoplanet.gp.terms.SHOTerm"><code class="xref py py-class docutils literal notranslate"><span class="pre">exoplanet.gp.terms.SHOTerm</span></code></a> objects.</p>
<p>First, generate the simulated data:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span>

<span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span>
    <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">3.8</span><span class="p">,</span> <span class="mi">57</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="mf">5.5</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">68</span><span class="p">))</span>
<span class="p">)</span>  <span class="c1"># The input coordinates must be sorted</span>
<span class="n">yerr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="mf">0.08</span><span class="p">,</span> <span class="mf">0.22</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">t</span><span class="p">))</span>
<span class="n">y</span> <span class="o">=</span> <span class="p">(</span>
    <span class="mf">0.2</span> <span class="o">*</span> <span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="mi">5</span><span class="p">)</span>
    <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">3</span> <span class="o">*</span> <span class="n">t</span> <span class="o">+</span> <span class="mf">0.1</span> <span class="o">*</span> <span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="mi">5</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span>
    <span class="o">+</span> <span class="n">yerr</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">t</span><span class="p">))</span>
<span class="p">)</span>

<span class="n">true_t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">5000</span><span class="p">)</span>
<span class="n">true_y</span> <span class="o">=</span> <span class="mf">0.2</span> <span class="o">*</span> <span class="p">(</span><span class="n">true_t</span> <span class="o">-</span> <span class="mi">5</span><span class="p">)</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">3</span> <span class="o">*</span> <span class="n">true_t</span> <span class="o">+</span> <span class="mf">0.1</span> <span class="o">*</span> <span class="p">(</span><span class="n">true_t</span> <span class="o">-</span> <span class="mi">5</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">errorbar</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">yerr</span><span class="o">=</span><span class="n">yerr</span><span class="p">,</span> <span class="n">fmt</span><span class="o">=</span><span class="s2">&quot;.k&quot;</span><span class="p">,</span> <span class="n">capsize</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;data&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">true_t</span><span class="p">,</span> <span class="n">true_y</span><span class="p">,</span> <span class="s2">&quot;k&quot;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;truth&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;t&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;y&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="o">-</span><span class="mf">2.5</span><span class="p">,</span> <span class="mf">2.5</span><span class="p">)</span>
</pre></div>
</div>
<img alt="../../_images/gp_6_0.png" src="../../_images/gp_6_0.png" />
<p>This plot shows the simulated data as black points with error bars and
the true function is shown as a gray line.</p>
<p>Now let’s build the PyMC3 model that we’ll use to fit the data. We can
see that there’s some roughly periodic signal in the data as well as a
longer term trend. To capture these two features, we will model this as
a mixture of two stochastically driven simple harmonic oscillators (SHO)
with the power spectrum:</p>
<div class="math notranslate nohighlight">
\[S(\omega) = \sqrt{\frac{2}{\pi}}\frac{S_1\,{\omega_1}^4}{(\omega^2 - {\omega_1}^2)^2 + 2\,{\omega_1}^2\,\omega^2}
   + \sqrt{\frac{2}{\pi}}\frac{S_2\,{\omega_2}^4}{(\omega^2 - {\omega_2}^2)^2 + {\omega_2}^2\,\omega^2/Q^2}\]</div>
<p>The first term is <code class="xref py py-class docutils literal notranslate"><span class="pre">exoplanet.gp.terms.SHOterm</span></code> with
<span class="math notranslate nohighlight">\(Q=1/\sqrt{2}\)</span> and the second is regular
<code class="xref py py-class docutils literal notranslate"><span class="pre">exoplanet.gp.terms.SHOterm</span></code>. This model has 5 free parameters
(<span class="math notranslate nohighlight">\(S_1\)</span>, <span class="math notranslate nohighlight">\(\omega_1\)</span>, <span class="math notranslate nohighlight">\(S_2\)</span>, <span class="math notranslate nohighlight">\(\omega_2\)</span>, and
<span class="math notranslate nohighlight">\(Q\)</span>) and they must all be positive so we’ll fit for the log of
each parameter. Using <em>exoplanet</em>, this is how you would build this
model, choosing more or less arbitrary initial values for the
parameters.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pymc3</span> <span class="k">as</span> <span class="nn">pm</span>
<span class="kn">import</span> <span class="nn">theano.tensor</span> <span class="k">as</span> <span class="nn">tt</span>
<span class="kn">from</span> <span class="nn">exoplanet.gp</span> <span class="kn">import</span> <span class="n">terms</span><span class="p">,</span> <span class="n">GP</span>

<span class="k">with</span> <span class="n">pm</span><span class="o">.</span><span class="n">Model</span><span class="p">()</span> <span class="k">as</span> <span class="n">model</span><span class="p">:</span>

    <span class="n">mean</span> <span class="o">=</span> <span class="n">pm</span><span class="o">.</span><span class="n">Normal</span><span class="p">(</span><span class="s2">&quot;mean&quot;</span><span class="p">,</span> <span class="n">mu</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="mf">1.0</span><span class="p">)</span>
    <span class="n">logS1</span> <span class="o">=</span> <span class="n">pm</span><span class="o">.</span><span class="n">Normal</span><span class="p">(</span><span class="s2">&quot;logS1&quot;</span><span class="p">,</span> <span class="n">mu</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="mf">15.0</span><span class="p">,</span> <span class="n">testval</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">var</span><span class="p">(</span><span class="n">y</span><span class="p">)))</span>
    <span class="n">logw1</span> <span class="o">=</span> <span class="n">pm</span><span class="o">.</span><span class="n">Normal</span><span class="p">(</span><span class="s2">&quot;logw1&quot;</span><span class="p">,</span> <span class="n">mu</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="mf">15.0</span><span class="p">,</span> <span class="n">testval</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mf">3.0</span><span class="p">))</span>
    <span class="n">logS2</span> <span class="o">=</span> <span class="n">pm</span><span class="o">.</span><span class="n">Normal</span><span class="p">(</span><span class="s2">&quot;logS2&quot;</span><span class="p">,</span> <span class="n">mu</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="mf">15.0</span><span class="p">,</span> <span class="n">testval</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">var</span><span class="p">(</span><span class="n">y</span><span class="p">)))</span>
    <span class="n">logw2</span> <span class="o">=</span> <span class="n">pm</span><span class="o">.</span><span class="n">Normal</span><span class="p">(</span><span class="s2">&quot;logw2&quot;</span><span class="p">,</span> <span class="n">mu</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="mf">15.0</span><span class="p">,</span> <span class="n">testval</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mf">3.0</span><span class="p">))</span>
    <span class="n">logQ</span> <span class="o">=</span> <span class="n">pm</span><span class="o">.</span><span class="n">Normal</span><span class="p">(</span><span class="s2">&quot;logQ&quot;</span><span class="p">,</span> <span class="n">mu</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="mf">15.0</span><span class="p">,</span> <span class="n">testval</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

    <span class="c1"># Set up the kernel an GP</span>
    <span class="n">kernel</span> <span class="o">=</span> <span class="n">terms</span><span class="o">.</span><span class="n">SHOTerm</span><span class="p">(</span><span class="n">log_S0</span><span class="o">=</span><span class="n">logS1</span><span class="p">,</span> <span class="n">log_w0</span><span class="o">=</span><span class="n">logw1</span><span class="p">,</span> <span class="n">Q</span><span class="o">=</span><span class="mf">1.0</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
    <span class="n">kernel</span> <span class="o">+=</span> <span class="n">terms</span><span class="o">.</span><span class="n">SHOTerm</span><span class="p">(</span><span class="n">log_S0</span><span class="o">=</span><span class="n">logS2</span><span class="p">,</span> <span class="n">log_w0</span><span class="o">=</span><span class="n">logw2</span><span class="p">,</span> <span class="n">log_Q</span><span class="o">=</span><span class="n">logQ</span><span class="p">)</span>
    <span class="n">gp</span> <span class="o">=</span> <span class="n">GP</span><span class="p">(</span><span class="n">kernel</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">yerr</span> <span class="o">**</span> <span class="mi">2</span><span class="p">,</span> <span class="n">mean</span><span class="o">=</span><span class="n">mean</span><span class="p">)</span>

    <span class="c1"># Condition the GP on the observations and add the marginal likelihood</span>
    <span class="c1"># to the model</span>
    <span class="n">gp</span><span class="o">.</span><span class="n">marginal</span><span class="p">(</span><span class="s2">&quot;gp&quot;</span><span class="p">,</span> <span class="n">observed</span><span class="o">=</span><span class="n">y</span><span class="p">)</span>
</pre></div>
</div>
<p>A few comments here:</p>
<ol class="arabic simple">
<li><p>The <code class="docutils literal notranslate"><span class="pre">term</span></code> interface in <em>exoplanet</em> only accepts keyword arguments
with names given by the <code class="docutils literal notranslate"><span class="pre">parameter_names</span></code> property of the term. But
it will also interpret keyword arguments with the name prefaced by
<code class="docutils literal notranslate"><span class="pre">log_</span></code> to be the log of the parameter. For example, in this case,
we used <code class="docutils literal notranslate"><span class="pre">log_S0</span></code> as the parameter for each term, but
<code class="docutils literal notranslate"><span class="pre">S0=tt.exp(log_S0)</span></code> would have been equivalent. This is useful
because many of the parameters are required to be positive so fitting
the log of those parameters is often best.</p></li>
<li><p>The third argument to the <a class="reference internal" href="../../user/api/#exoplanet.gp.GP" title="exoplanet.gp.GP"><code class="xref py py-class docutils literal notranslate"><span class="pre">exoplanet.gp.GP</span></code></a> constructor
should be the <em>variance</em> to add along the diagonal, not the standard
deviation as in the original <a class="reference external" href="https://celerite.readthedocs.io">celerite
implementation</a>.</p></li>
<li><p>Finally, the <a class="reference internal" href="../../user/api/#exoplanet.gp.GP" title="exoplanet.gp.GP"><code class="xref py py-class docutils literal notranslate"><span class="pre">exoplanet.gp.GP</span></code></a> constructor takes an optional
argument <code class="docutils literal notranslate"><span class="pre">J</span></code> which specifies the width of the problem if it is
known at compile time. Just to be confusing, this is actually two
times the <code class="docutils literal notranslate"><span class="pre">J</span></code> from <a class="reference external" href="https://arxiv.org/abs/1703.09710">the celerite
paper</a>. There are various
technical reasons why this is difficult to work out in general and
this code will always work if you don’t provide a value for <code class="docutils literal notranslate"><span class="pre">J</span></code>,
but you can get much better performance (especially for small <code class="docutils literal notranslate"><span class="pre">J</span></code>)
if you know what it will be for your problem. In general, most terms
cost <code class="docutils literal notranslate"><span class="pre">J=2</span></code> with the exception of a
<a class="reference internal" href="../../user/api/#exoplanet.gp.terms.RealTerm" title="exoplanet.gp.terms.RealTerm"><code class="xref py py-class docutils literal notranslate"><span class="pre">exoplanet.gp.terms.RealTerm</span></code></a> (which costs <cite>J=1</cite>) and a
<a class="reference internal" href="../../user/api/#exoplanet.gp.terms.RotationTerm" title="exoplanet.gp.terms.RotationTerm"><code class="xref py py-class docutils literal notranslate"><span class="pre">exoplanet.gp.terms.RotationTerm</span></code></a> (which costs <cite>J=4</cite>).</p></li>
</ol>
<p>To start, let’s fit for the maximum a posteriori (MAP) parameters and
look the the predictions that those make.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">exoplanet</span> <span class="k">as</span> <span class="nn">xo</span>

<span class="k">with</span> <span class="n">model</span><span class="p">:</span>
    <span class="n">map_soln</span> <span class="o">=</span> <span class="n">xo</span><span class="o">.</span><span class="n">optimize</span><span class="p">(</span><span class="n">start</span><span class="o">=</span><span class="n">model</span><span class="o">.</span><span class="n">test_point</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">optimizing</span> <span class="n">logp</span> <span class="k">for</span> <span class="n">variables</span><span class="p">:</span> <span class="p">[</span><span class="n">logQ</span><span class="p">,</span> <span class="n">logw2</span><span class="p">,</span> <span class="n">logS2</span><span class="p">,</span> <span class="n">logw1</span><span class="p">,</span> <span class="n">logS1</span><span class="p">,</span> <span class="n">mean</span><span class="p">]</span>
<span class="mi">50</span><span class="n">it</span> <span class="p">[</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">,</span> <span class="mf">71.74</span><span class="n">it</span><span class="o">/</span><span class="n">s</span><span class="p">,</span> <span class="n">logp</span><span class="o">=-</span><span class="mf">2.569892e+00</span><span class="p">]</span>
<span class="n">message</span><span class="p">:</span> <span class="n">Optimization</span> <span class="n">terminated</span> <span class="n">successfully</span><span class="o">.</span>
<span class="n">logp</span><span class="p">:</span> <span class="o">-</span><span class="mf">41.9875698144546</span> <span class="o">-&gt;</span> <span class="o">-</span><span class="mf">2.569892168573091</span>
</pre></div>
</div>
<p>We’ll use the <a class="reference internal" href="../../user/api/#exoplanet.eval_in_model" title="exoplanet.eval_in_model"><code class="xref py py-func docutils literal notranslate"><span class="pre">exoplanet.eval_in_model()</span></code></a> function to evaluate the
MAP GP model.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">with</span> <span class="n">model</span><span class="p">:</span>
    <span class="n">mu</span><span class="p">,</span> <span class="n">var</span> <span class="o">=</span> <span class="n">xo</span><span class="o">.</span><span class="n">eval_in_model</span><span class="p">(</span>
        <span class="n">gp</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">true_t</span><span class="p">,</span> <span class="n">return_var</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">predict_mean</span><span class="o">=</span><span class="kc">True</span><span class="p">),</span> <span class="n">map_soln</span>
    <span class="p">)</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">errorbar</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">yerr</span><span class="o">=</span><span class="n">yerr</span><span class="p">,</span> <span class="n">fmt</span><span class="o">=</span><span class="s2">&quot;.k&quot;</span><span class="p">,</span> <span class="n">capsize</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;data&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">true_t</span><span class="p">,</span> <span class="n">true_y</span><span class="p">,</span> <span class="s2">&quot;k&quot;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;truth&quot;</span><span class="p">)</span>

<span class="c1"># Plot the prediction and the 1-sigma uncertainty</span>
<span class="n">sd</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">var</span><span class="p">)</span>
<span class="n">art</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">true_t</span><span class="p">,</span> <span class="n">mu</span> <span class="o">+</span> <span class="n">sd</span><span class="p">,</span> <span class="n">mu</span> <span class="o">-</span> <span class="n">sd</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;C1&quot;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>
<span class="n">art</span><span class="o">.</span><span class="n">set_edgecolor</span><span class="p">(</span><span class="s2">&quot;none&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">true_t</span><span class="p">,</span> <span class="n">mu</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;C1&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;prediction&quot;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;t&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;y&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="o">-</span><span class="mf">2.5</span><span class="p">,</span> <span class="mf">2.5</span><span class="p">)</span>
</pre></div>
</div>
<img alt="../../_images/gp_13_0.png" src="../../_images/gp_13_0.png" />
<p>Now we can sample this model using PyMC3. There are strong covariances
between the parameters so we’ll use the custom
<a class="reference internal" href="../../user/api/#exoplanet.get_dense_nuts_step" title="exoplanet.get_dense_nuts_step"><code class="xref py py-func docutils literal notranslate"><span class="pre">exoplanet.get_dense_nuts_step()</span></code></a> to fit for these covariances
during burn-in.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">with</span> <span class="n">model</span><span class="p">:</span>
    <span class="n">trace</span> <span class="o">=</span> <span class="n">pm</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span>
        <span class="n">tune</span><span class="o">=</span><span class="mi">2000</span><span class="p">,</span>
        <span class="n">draws</span><span class="o">=</span><span class="mi">2000</span><span class="p">,</span>
        <span class="n">start</span><span class="o">=</span><span class="n">map_soln</span><span class="p">,</span>
        <span class="n">cores</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
        <span class="n">chains</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
        <span class="n">step</span><span class="o">=</span><span class="n">xo</span><span class="o">.</span><span class="n">get_dense_nuts_step</span><span class="p">(</span><span class="n">target_accept</span><span class="o">=</span><span class="mf">0.9</span><span class="p">),</span>
    <span class="p">)</span>
</pre></div>
</div>
<pre class="literal-block">Multiprocess sampling (2 chains in 2 jobs)
NUTS: [logQ, logw2, logS2, logw1, logS1, mean]
Sampling 2 chains, 36 divergences: 100%|██████████| 8000/8000 [00:44&lt;00:00, 178.95draws/s]
There were 35 divergences after tuning. Increase <cite>target_accept</cite> or reparameterize.
There was 1 divergence after tuning. Increase <cite>target_accept</cite> or reparameterize.
The number of effective samples is smaller than 10% for some parameters.</pre>
<p>Now we can compute the standard PyMC3 convergence statistics (using
<code class="docutils literal notranslate"><span class="pre">pymc3.summary</span></code>) and make a trace plot (using <code class="docutils literal notranslate"><span class="pre">pymc3.traceplot</span></code>).</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">pm</span><span class="o">.</span><span class="n">traceplot</span><span class="p">(</span><span class="n">trace</span><span class="p">)</span>
<span class="n">pm</span><span class="o">.</span><span class="n">summary</span><span class="p">(</span><span class="n">trace</span><span class="p">)</span>
</pre></div>
</div>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>mean</th>
      <th>sd</th>
      <th>hpd_3%</th>
      <th>hpd_97%</th>
      <th>mcse_mean</th>
      <th>mcse_sd</th>
      <th>ess_mean</th>
      <th>ess_sd</th>
      <th>ess_bulk</th>
      <th>ess_tail</th>
      <th>r_hat</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>mean</th>
      <td>0.006</td>
      <td>0.868</td>
      <td>-1.719</td>
      <td>1.568</td>
      <td>0.017</td>
      <td>0.017</td>
      <td>2555.0</td>
      <td>1306.0</td>
      <td>2578.0</td>
      <td>2294.0</td>
      <td>1.00</td>
    </tr>
    <tr>
      <th>logS1</th>
      <td>5.189</td>
      <td>3.471</td>
      <td>-0.544</td>
      <td>11.633</td>
      <td>0.102</td>
      <td>0.072</td>
      <td>1156.0</td>
      <td>1156.0</td>
      <td>629.0</td>
      <td>397.0</td>
      <td>1.01</td>
    </tr>
    <tr>
      <th>logw1</th>
      <td>-2.528</td>
      <td>1.324</td>
      <td>-5.135</td>
      <td>-0.076</td>
      <td>0.063</td>
      <td>0.045</td>
      <td>442.0</td>
      <td>442.0</td>
      <td>377.0</td>
      <td>119.0</td>
      <td>1.01</td>
    </tr>
    <tr>
      <th>logS2</th>
      <td>-4.176</td>
      <td>0.868</td>
      <td>-4.993</td>
      <td>-3.111</td>
      <td>0.101</td>
      <td>0.077</td>
      <td>74.0</td>
      <td>64.0</td>
      <td>422.0</td>
      <td>120.0</td>
      <td>1.01</td>
    </tr>
    <tr>
      <th>logw2</th>
      <td>1.129</td>
      <td>0.051</td>
      <td>1.032</td>
      <td>1.224</td>
      <td>0.001</td>
      <td>0.001</td>
      <td>2137.0</td>
      <td>2137.0</td>
      <td>2351.0</td>
      <td>1764.0</td>
      <td>1.00</td>
    </tr>
    <tr>
      <th>logQ</th>
      <td>2.951</td>
      <td>1.353</td>
      <td>1.102</td>
      <td>5.377</td>
      <td>0.101</td>
      <td>0.087</td>
      <td>180.0</td>
      <td>120.0</td>
      <td>472.0</td>
      <td>203.0</td>
      <td>1.01</td>
    </tr>
  </tbody>
</table>
</div><img alt="../../_images/gp_17_1.png" src="../../_images/gp_17_1.png" />
<p>That all looks pretty good, but I like to make two other results plots:
(1) a <a class="reference external" href="https://corner.readthedocs.io">corner plot</a> and (2) a
posterior predictive plot.</p>
<p>The corner plot is easy using <code class="docutils literal notranslate"><span class="pre">pymc3.trace_to_dataframe</span></code> and I find it
useful for understanding the covariances between parameters when
debugging.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">corner</span>

<span class="n">samples</span> <span class="o">=</span> <span class="n">pm</span><span class="o">.</span><span class="n">trace_to_dataframe</span><span class="p">(</span><span class="n">trace</span><span class="p">)</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">corner</span><span class="o">.</span><span class="n">corner</span><span class="p">(</span><span class="n">samples</span><span class="p">)</span>
</pre></div>
</div>
<img alt="../../_images/gp_19_0.png" src="../../_images/gp_19_0.png" />
<p>The “posterior predictive” plot that I like to make isn’t the same as a
“posterior predictive check” (which can be a good thing to do too).
Instead, I like to look at the predictions of the model in the space of
the data. We could have saved these predictions using a
<code class="docutils literal notranslate"><span class="pre">pymc3.Deterministic</span></code> distribution, but that adds some overhead to
each evaluation of the model so instead, we can use
<code class="xref py py-func docutils literal notranslate"><span class="pre">exoplanet.utils.get_samples_from_trace()</span></code> to loop over a few
random samples from the chain and then the
<a class="reference internal" href="../../user/api/#exoplanet.eval_in_model" title="exoplanet.eval_in_model"><code class="xref py py-func docutils literal notranslate"><span class="pre">exoplanet.eval_in_model()</span></code></a> function to evaluate the prediction
just for those samples.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Generate 50 realizations of the prediction sampling randomly from the chain</span>
<span class="n">N_pred</span> <span class="o">=</span> <span class="mi">50</span>
<span class="n">pred_mu</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">((</span><span class="n">N_pred</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">true_t</span><span class="p">)))</span>
<span class="n">pred_var</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">((</span><span class="n">N_pred</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">true_t</span><span class="p">)))</span>
<span class="k">with</span> <span class="n">model</span><span class="p">:</span>
    <span class="n">pred</span> <span class="o">=</span> <span class="n">gp</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">true_t</span><span class="p">,</span> <span class="n">return_var</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">predict_mean</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">sample</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">xo</span><span class="o">.</span><span class="n">get_samples_from_trace</span><span class="p">(</span><span class="n">trace</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">N_pred</span><span class="p">)):</span>
        <span class="n">pred_mu</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">pred_var</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">xo</span><span class="o">.</span><span class="n">eval_in_model</span><span class="p">(</span><span class="n">pred</span><span class="p">,</span> <span class="n">sample</span><span class="p">)</span>

<span class="c1"># Plot the predictions</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">pred_mu</span><span class="p">)):</span>
    <span class="n">mu</span> <span class="o">=</span> <span class="n">pred_mu</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
    <span class="n">sd</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">pred_var</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
    <span class="n">label</span> <span class="o">=</span> <span class="kc">None</span> <span class="k">if</span> <span class="n">i</span> <span class="k">else</span> <span class="s2">&quot;prediction&quot;</span>
    <span class="n">art</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">true_t</span><span class="p">,</span> <span class="n">mu</span> <span class="o">+</span> <span class="n">sd</span><span class="p">,</span> <span class="n">mu</span> <span class="o">-</span> <span class="n">sd</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;C1&quot;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span>
    <span class="n">art</span><span class="o">.</span><span class="n">set_edgecolor</span><span class="p">(</span><span class="s2">&quot;none&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">true_t</span><span class="p">,</span> <span class="n">mu</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;C1&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">label</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">errorbar</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">yerr</span><span class="o">=</span><span class="n">yerr</span><span class="p">,</span> <span class="n">fmt</span><span class="o">=</span><span class="s2">&quot;.k&quot;</span><span class="p">,</span> <span class="n">capsize</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;data&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">true_t</span><span class="p">,</span> <span class="n">true_y</span><span class="p">,</span> <span class="s2">&quot;k&quot;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;truth&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;t&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;y&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="o">-</span><span class="mf">2.5</span><span class="p">,</span> <span class="mf">2.5</span><span class="p">)</span>
</pre></div>
</div>
<img alt="../../_images/gp_21_0.png" src="../../_images/gp_21_0.png" />
<div class="section" id="citations">
<h2>Citations<a class="headerlink" href="#citations" title="Permalink to this headline">¶</a></h2>
<p>As described in the <a class="reference internal" href="../citation/#citation"><span class="std std-ref">Citing exoplanet &amp; its dependencies</span></a> tutorial, we can use
<a class="reference internal" href="../../user/api/#exoplanet.citations.get_citations_for_model" title="exoplanet.citations.get_citations_for_model"><code class="xref py py-func docutils literal notranslate"><span class="pre">exoplanet.citations.get_citations_for_model()</span></code></a> to construct an
acknowledgement and BibTeX listing that includes the relevant citations
for this model.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">with</span> <span class="n">model</span><span class="p">:</span>
    <span class="n">txt</span><span class="p">,</span> <span class="n">bib</span> <span class="o">=</span> <span class="n">xo</span><span class="o">.</span><span class="n">citations</span><span class="o">.</span><span class="n">get_citations_for_model</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">txt</span><span class="p">)</span>
</pre></div>
</div>
<pre class="literal-block">This research made use of textsf{exoplanet} citep{exoplanet} and its
dependencies citep{exoplanet:exoplanet, exoplanet:foremanmackey17,
exoplanet:foremanmackey18, exoplanet:pymc3, exoplanet:theano}.</pre>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">bib</span><span class="o">.</span><span class="n">splitlines</span><span class="p">()[:</span><span class="mi">10</span><span class="p">])</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">...&quot;</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nd">@misc</span><span class="p">{</span><span class="n">exoplanet</span><span class="p">:</span><span class="n">exoplanet</span><span class="p">,</span>
  <span class="n">author</span> <span class="o">=</span> <span class="p">{</span><span class="n">Daniel</span> <span class="n">Foreman</span><span class="o">-</span><span class="n">Mackey</span> <span class="ow">and</span> <span class="n">Ian</span> <span class="n">Czekala</span> <span class="ow">and</span> <span class="n">Rodrigo</span> <span class="n">Luger</span> <span class="ow">and</span>
            <span class="n">Eric</span> <span class="n">Agol</span> <span class="ow">and</span> <span class="n">Geert</span> <span class="n">Barentsen</span> <span class="ow">and</span> <span class="n">Tom</span> <span class="n">Barclay</span><span class="p">},</span>
   <span class="n">title</span> <span class="o">=</span> <span class="p">{</span><span class="n">exoplanet</span><span class="o">-</span><span class="n">dev</span><span class="o">/</span><span class="n">exoplanet</span> <span class="n">v0</span><span class="o">.</span><span class="mf">3.0</span><span class="p">},</span>
   <span class="n">month</span> <span class="o">=</span> <span class="n">apr</span><span class="p">,</span>
    <span class="n">year</span> <span class="o">=</span> <span class="mi">2020</span><span class="p">,</span>
     <span class="n">doi</span> <span class="o">=</span> <span class="p">{</span><span class="mf">10.5281</span><span class="o">/</span><span class="n">zenodo</span><span class="o">.</span><span class="mi">1998447</span><span class="p">},</span>
     <span class="n">url</span> <span class="o">=</span> <span class="p">{</span><span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">doi</span><span class="o">.</span><span class="n">org</span><span class="o">/</span><span class="mf">10.5281</span><span class="o">/</span><span class="n">zenodo</span><span class="o">.</span><span class="mi">1998447</span><span class="p">}</span>
<span class="p">}</span>
<span class="o">...</span>
</pre></div>
</div>
</div>
</div>

  <div class="t-pagination clearfix">
    <span>
      ← <a href="../astrometric/" title="Astrometric fitting">Astrometric fitting</a>
    </span>
  </div>


    </div>
<footer class="t-foot">
    &copy; Copyright 2018, 2019, 2020, Dan Foreman-Mackey.
    <br>
    A <a href="https://typlog.com/">typlog</a> <a href="https://github.com/typlog/sphinx-typlog-theme">sphinx theme</a>,
    designed by <a href="https://lepture.com/">Hsiaoming Yang</a>.
</footer>

<script id="versions-template" type="x-tmpl-mustache">
<div class="versions">
    <div class="current-version">
        move-tests
        <span class="fas fa-caret-down"></span>
    </div>
    <dl class="versions-dropdown">
        {{#versions}}
        <dd><a href="https://docs.exoplanet.codes/en/{{.}}/tutorials/gp">{{.}}</a></dd>
        {{/versions}}
    </dl>
</div>
</script>

  </div>
  <script>$(function(){$(".t-head_menu").on("click",function(){$("body").addClass("_expand")});$(".t-body").on("click",function(){$("body").removeClass("_expand")});$(".t-sidebar_close").on("click",function(){$("body").removeClass("_expand")});$("a.footnote-reference").on("click",function(e){e.preventDefault();var id=$(this).attr("href");var html=$(id).find("td.label + td").html();var w=Math.max(document.documentElement.clientWidth,window.innerWidth||0);var style="top:"+e.pageY+"px;";if(w>560){style+="width:480px;";if(e.pageX>240&&e.pageX+240<w){style+="left:"+(e.pageX-240)+"px;"}else if(e.pageX<=240){style+="left:20px;"}else{style+="right:20px;"}}showFootnote(html,style)});function showFootnote(html,style){var CONTENT_ID="typlog-footnote-content";var content=document.getElementById(CONTENT_ID);if(!content){content=document.createElement("div");content.id=CONTENT_ID;$(".t-body").append(content)}var MASK_ID="typlog-footnote-mask";var mask=document.getElementById(MASK_ID);if(!mask){mask=document.createElement("div");mask.id=MASK_ID;document.body.appendChild(mask);mask.addEventListener("click",function(){content.className="";mask.className=""})}content.innerHTML=html;content.setAttribute("style",style);content.className="_active";mask.className="_active"}function fetchGitHubRepo(repo){var url="https://api.github.com/repos/"+repo;$.getJSON(url,function(data){var counts=[+new Date,data.stargazers_count,data.forks_count];localStorage.setItem("gh:"+repo,JSON.stringify(counts));updateGitHubStats(counts[1],counts[2])})}function updateGitHubStats(stars,forks){$(".github_stars strong").text(stars);$(".github_forks strong").text(forks)}function initGitHub(url){if(!url){return}var repo=url.replace("https://github.com/","");var cache=localStorage.getItem("gh:"+repo);if(cache){try{var counts=JSON.parse(cache);updateGitHubStats(counts[1],counts[2]);var delta=new Date-counts[0];if(delta<0||delta>9e5){fetchGitHubRepo(repo)}}catch(error){fetchGitHubRepo(repo)}}else{fetchGitHubRepo(repo)}}initGitHub($(".github").attr("href"))});</script>
</body>
</html>